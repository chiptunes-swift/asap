CC = @CC@
INSTALL = @INSTALL@
INSTALL_PROGRAM = @INSTALL_PROGRAM@ -s
INSTALL_DATA = @INSTALL_DATA@

CFLAGS = @CFLAGS@
LDFLAGS = @LDFLAGS@
DEFS = @DEFS@ -DASAP -DSOUND
LIBS = @LIBS@
TARGET = asap2wav@EXEEXT@

ATARI800_SRC_DIR = ../atari800/src
SRC = asap.c $(ATARI800_SRC_DIR)/cpu.c $(ATARI800_SRC_DIR)/mzpokeysnd.c $(ATARI800_SRC_DIR)/pokeysnd.c $(ATARI800_SRC_DIR)/remez.c

all: $(TARGET)

$(TARGET): asap2wav.c $(SRC) players.h
	$(CC) $(CFLAGS) $(LDFLAGS) -o $@ $(DEFS) -I. -I$(ATARI800_SRC_DIR) $^ $(LIBS)

players.h: raw2c.pl cmc_0500.raw mpt_0500.raw tmc_0500.raw
	perl $^ >$@

install: $(TARGET) asap2wav.1
	$(INSTALL_PROGRAM) $(TARGET) $(DESTDIR)@prefix@/bin/$(TARGET)
	$(INSTALL_DATA) asap2wav.1 $(DESTDIR)@prefix@/share/man/man1/asap2wav.1

uninstall:
	rm $(DESTDIR)@prefix@/bin/$(TARGET)
	rm $(DESTDIR)@prefix@/share/man/man1/asap2wav.1

clean:
	rm -f players.h $(TARGET) core *.bak *~

distclean: clean
	-rm -f Makefile config.log config.status config.h configure config.h.in
	-rm -rf autom4te.cache
